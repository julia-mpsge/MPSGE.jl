<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Closed 2times2 Economy with Intermediate Inputs and Nesting · MPSGE.jl</title><meta name="title" content="Closed 2times2 Economy with Intermediate Inputs and Nesting · MPSGE.jl"/><meta property="og:title" content="Closed 2times2 Economy with Intermediate Inputs and Nesting · MPSGE.jl"/><meta property="twitter:title" content="Closed 2times2 Economy with Intermediate Inputs and Nesting · MPSGE.jl"/><meta name="description" content="Documentation for MPSGE.jl."/><meta property="og:description" content="Documentation for MPSGE.jl."/><meta property="twitter:description" content="Documentation for MPSGE.jl."/><meta property="og:url" content="https://julia-mpsge.github.io/MPSGE.jl/Tutorials/intermediate_examples/M22/"/><meta property="twitter:url" content="https://julia-mpsge.github.io/MPSGE.jl/Tutorials/intermediate_examples/M22/"/><link rel="canonical" href="https://julia-mpsge.github.io/MPSGE.jl/Tutorials/intermediate_examples/M22/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">MPSGE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../../../">MPSGE</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Getting Started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../getting_started/introduction/">Introduction</a></li><li><a class="tocitem" href="../../getting_started/getting_started_mpsge/">Getting Started with MPSGE</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Basic Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../basic_examples/m1_mpsge/">Closed 2-good, 2-factor economy with fixed factor endowments and one representative agent</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Intermediate Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Closed <span>$2\times2$</span> Economy with Intermediate Inputs and Nesting</a><ul class="internal"><li><a class="tocitem" href="#Model-Initialization"><span>Model Initialization</span></a></li><li><a class="tocitem" href="#Defining-Variables"><span>Defining Variables</span></a></li><li><a class="tocitem" href="#Parameters"><span>Parameters</span></a></li><li><a class="tocitem" href="#Production"><span>Production</span></a></li><li><a class="tocitem" href="#Demand"><span>Demand</span></a></li><li class="toplevel"><a class="tocitem" href="#Solving-the-Model"><span>Solving the Model</span></a></li></ul></li></ul></li></ul></li><li><span class="tocitem">How it works</span><ul><li><a class="tocitem" href="../../../how_it_works/">How MPSGE Works</a></li></ul></li><li><span class="tocitem">Docstrings</span><ul><li><a class="tocitem" href="../../../docs/">-</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li><a class="is-disabled">Intermediate Examples</a></li><li class="is-active"><a href>Closed <span>$2\times2$</span> Economy with Intermediate Inputs and Nesting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Closed <span>$2\times2$</span> Economy with Intermediate Inputs and Nesting</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/julia-mpsge/MPSGE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/julia-mpsge/MPSGE.jl/blob/main/docs/src/Tutorials/intermediate_examples/M22.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Closed-2\\times2-Economy-with-Intermediate-Inputs-and-Nesting"><a class="docs-heading-anchor" href="#Closed-2\\times2-Economy-with-Intermediate-Inputs-and-Nesting">Closed <span>$2\times2$</span> Economy with Intermediate Inputs and Nesting</a><a id="Closed-2\\times2-Economy-with-Intermediate-Inputs-and-Nesting-1"></a><a class="docs-heading-anchor-permalink" href="#Closed-2\\times2-Economy-with-Intermediate-Inputs-and-Nesting" title="Permalink"></a></h1><p>This model is available in a notebook file <a href="https://github.com/julia-mpsge/MPSGE.jl/blob/main/examples/M22.ipynb">here</a>.</p><p>Consider the following social accounting matrix (SAM). </p><table><tr><th style="text-align: center">Markets</th><th style="text-align: center">X</th><th style="text-align: center">Y</th><th style="text-align: center">W</th><th style="text-align: center">CONS</th></tr><tr><td style="text-align: center">PX</td><td style="text-align: center">120</td><td style="text-align: center">-20</td><td style="text-align: center">-100</td><td style="text-align: center"></td></tr><tr><td style="text-align: center">PY</td><td style="text-align: center">-20</td><td style="text-align: center">120</td><td style="text-align: center">-100</td><td style="text-align: center"></td></tr><tr><td style="text-align: center">PW</td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center">200</td><td style="text-align: center">-200</td></tr><tr><td style="text-align: center">PL</td><td style="text-align: center">-40</td><td style="text-align: center">-60</td><td style="text-align: center"></td><td style="text-align: center">100</td></tr><tr><td style="text-align: center">PK</td><td style="text-align: center">-60</td><td style="text-align: center">-40</td><td style="text-align: center"></td><td style="text-align: center">100</td></tr></table><p>We are going to use this matrix to construct a simple CES nesting structure that permits the modeler to specify different elasticities of substitution between different groups of inputs.</p><p>While the SAM contains the data to build the model, it doesn&#39;t specify any structure. To  do this we use a tree diagram. For this model we will have four trees: <code>X</code>, <code>Y</code>, <code>W</code>, <code>CONS</code>.</p><p><img src="../../../images/m22_model.png" alt="Specific Model Description"/></p><h2 id="Model-Initialization"><a class="docs-heading-anchor" href="#Model-Initialization">Model Initialization</a><a id="Model-Initialization-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Initialization" title="Permalink"></a></h2><p>First we import <code>MPSGE</code> and initialize the model.</p><pre><code class="language-julia hljs">using MPSGE

M = MPSGEModel()</code></pre><h2 id="Defining-Variables"><a class="docs-heading-anchor" href="#Defining-Variables">Defining Variables</a><a id="Defining-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-Variables" title="Permalink"></a></h2><p>This model has:</p><ol><li>Three sectors <code>X</code>, <code>Y</code>, and <code>W</code></li><li>Five commodities <code>PX</code>, <code>PY</code>, <code>PW</code>, <code>PL</code>, and <code>PK</code></li><li>One consumer <code>CONS</code></li></ol><p>Let&#39;s add these to the model.</p><pre><code class="language-julia hljs">@sectors(M, begin
    X
    Y
    W
end)

@commodities(M, begin
    PX
    PY
    PW
    PL
    PK
end)

@consumer(M, CONS)</code></pre><p>We use the plural version of both <code>sector</code> and <code>commodity</code> because we have  multiple of each. Each of these variables has been added to the local  namespace, so we can type <code>X</code> and it will display <code>X</code>. This is useful as we continue to build the model. These can also be accessed directly from the model, <code>M[:X]</code>. </p><h2 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h2><p>In this model we will want a two parameters, <code>tax</code> and <code>σ</code>. This will allow us to apply various shocks without recompiling the model.</p><pre><code class="language-julia hljs">@parameters(M, begin
    tax, 0
    σ, .5
end)</code></pre><p>The parameter block requires that you set initial values for each parameter. </p><h2 id="Production"><a class="docs-heading-anchor" href="#Production">Production</a><a id="Production-1"></a><a class="docs-heading-anchor-permalink" href="#Production" title="Permalink"></a></h2><p>In this model we will have three production blocks, one for each sector. View the full <a href="../../../docs/#MPSGE.@production-NTuple{4, Any}"><code>@production</code></a> documentation.</p><p>We&#39;ll detail the <code>X</code> production block as it has the most interesting structure.  Here is the full production block,</p><pre><code class="language-julia hljs">@production(M, X, [s = σ, t = 0, va =&gt; s = 1], begin
    @output(PX, 120, t)
    @input( PY, 20,  s)
    @input( PL, 40,  va, taxes = [Tax(CONS,tax)])
    @input( PK, 60,  va, taxes = [Tax(CONS,tax)])
end)</code></pre><p>there is a lot going on in this, let&#39;s break it down piece by piece. The first few pieces, <code>@production(M, X,</code> are self-explanatory, model and  sector. </p><p>This brings us to <code>[s = σ, t = 0, va =&gt; s = 1]</code> which defines the nesting structure. There are two top level nests <code>s</code> and <code>t</code> with respective elasticities of <code>σ</code> and <code>0</code>. Compare this to the other nest, <code>va</code>, which sits under <code>s</code>, this is denoted with <code>va =&gt; s</code> and the <code>= 1</code> sets the elasticity to 1. One thing to notice is that <code>σ</code> is a previously defined parameter. In general, any quantity can be either a number or parameter.</p><p>Finally, <a href="../../../docs/#MPSGE.@input-Tuple{Any, Any, Any, Vararg{Any}}"><code>@input</code></a> and <a href="../../../docs/#MPSGE.@output-Tuple{Any, Any, Any, Vararg{Any}}"><code>@output</code></a>. These must be wrapped in the <code>begin .. end</code> syntax. The syntax of building an output is the same as an input, so we&#39;ll describe an  output. The required information is a commodity, quantity, and nest. We have used Julia macro syntax to suppress parentheses and commas, but you could  equivalently defined these as </p><pre><code class="language-julia hljs">@output(PX, 120, t)</code></pre><p>Outputs have two possible keywords, <code>reference_price</code> and <code>taxes</code>.  <code>reference_price</code> is a simple quantity whereas taxes is an array of <code>Tax</code> objects, as illustrated in the <code>PK</code> input. </p><p>The remaining production blocks are similar,</p><pre><code class="language-julia hljs">@production(M, Y, [t = 0, s = .75, va =&gt; s = 1], begin 
    @output( PY, 120, t)
    @input(  PX, 20, s)
    @input(  PL, 60, va)
    @input(  PK, 40, va)
end)

@production(M, W, [t = 0, s = 1], begin
    @output( PW, 200, t)
    @input(  PX, 100, s)
    @input(  PY, 100, s)
end)</code></pre><h2 id="Demand"><a class="docs-heading-anchor" href="#Demand">Demand</a><a id="Demand-1"></a><a class="docs-heading-anchor-permalink" href="#Demand" title="Permalink"></a></h2><p>Each consumer will have a corresponding demand block. Here is the demand block for <code>CONS</code></p><pre><code class="language-julia hljs">@demand(M, CONS, begin
    @final_demand(PW, 200)
    end,begin
    @endowment(PL, 100)
    @endowment(PK,100)
end)</code></pre><p>The first two inputs are the model and the consumer. Then there are two  <code>begin .. end</code> blocks, the first is for final demand and the second is  endowments. This may get improved in the future to be a single block. </p><h1 id="Solving-the-Model"><a class="docs-heading-anchor" href="#Solving-the-Model">Solving the Model</a><a id="Solving-the-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-the-Model" title="Permalink"></a></h1><p>To solve the model, you call <code>solve!</code> on the model. You can also pass PATH options view keyword arguments. In this case we are testing the  benchmark calibration so we set the cumulative iteration limit to 0.</p><pre><code class="language-julia hljs">solve!(M; cumulative_iteration_limit = 0)</code></pre><p>While the solver output can be useful, it&#39;s more useful to see the values and the marginal values. Any non-zero marginal value should be investigated.  LINK TO MODEL DEBUGGING INFORMATION HERE.</p><pre><code class="language-julia hljs">df_benchmark = generate_report(M)</code></pre><p>This will return a Julia dataframe, which you can manipulate using any dataframe technique. If you plan to manipulate this dataframe, it will be useful to use the DataFrames package</p><pre><code class="language-julia hljs">using DataFrames.jl</code></pre><p>You can also retrieve information using standard JuMP functions, for example</p><pre><code class="language-julia hljs">value(X)</code></pre><p>will give you the value of X. </p><p>We can solve a counterfactual by changing the value of a parameter. In this  case we&#39;ll also fix <code>PW</code> to 1 to pin a specific solution.</p><pre><code class="language-julia hljs">fix(PW,1)
set_value!(tax,.5)

solve!(M)
df = generate_report(M)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../basic_examples/m1_mpsge/">« Closed 2-good, 2-factor economy with fixed factor endowments and one representative agent</a><a class="docs-footer-nextpage" href="../../../how_it_works/">How MPSGE Works »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 29 July 2024 18:30">Monday 29 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
